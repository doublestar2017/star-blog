import{_ as e,g as a,i as n,s,u as l,k as i}from"./index.9e4483e4.js";import{d as t,a as o,j as d,Y as r,r as c,Q as u,_ as m,p as h,l as g,b as v,c as f,e as k,g as p,F as C,S as _,k as S,t as w,f as b,m as I}from"./vendor.a74009fa.js";import{_ as y}from"./user.9f14763c.js";var M=t({name:"Nav",components:{RegisterAndLogin:o((()=>e((()=>import("./RegisterAndLogin.5e9e1895.js")),["/star-blog/assets/RegisterAndLogin.5e9e1895.js","/star-blog/assets/RegisterAndLogin.e663d6f6.css","/star-blog/assets/vendor.a74009fa.js","/star-blog/assets/index.9e4483e4.js","/star-blog/assets/index.03b53dea.css"])))},computed:{userInfo(){let e={_id:"",name:"",avatar:""};return window.sessionStorage.userInfo&&(e=JSON.parse(window.sessionStorage.userInfo),this.$store.commit("SAVE_USER",{userInfo:e})),this.$store.state.user.userInfo&&(e=this.$store.state.user.userInfo),e}},watch:{$route:{handler(e,a){this.routeChange(e,a)},immediate:!0}},mounted(){this.routeChange(this.$route,this.$route);const e=a("code");e&&this.getUser(e)},setup(e,a){const t=d(i),o=r(),h=c({visible:!1,handleFlag:"",title:"首页",list:[{index:"1",path:"/",name:"首页"},{index:"2",path:"/articles",name:"文章"},{index:"3",path:"/archive",name:"归档"},{index:"4",path:"/project",name:"项目"},{index:"5",path:"/timeline",name:"历程"},{index:"6",path:"/message",name:"留言"},{index:"7",path:"/about",name:"关于"}],activeIndex:"0",enterSlideUp:!1,leaveSlideDown:!1,isShow:!1,isMobile:n()}),g=()=>{window.sessionStorage.userInfo="",t.commit("SAVE_USER",{userInfo:{_id:"",name:"",avatar:""}})};return{state:h,handleCancel:e=>{h.visible=e},handleOk:e=>{h.visible=e},handleClick:e=>{h.handleFlag=e,h.visible=!0},handleLogout:g,handleClickMenu:e=>{h.isShow=!1,"/login"===e&&(h.handleFlag="login",h.visible=!0),"/register"===e&&(h.handleFlag="register",h.visible=!0),"/logout"===e&&g()},handleMenu:()=>{h.isShow=!0,h.enterSlideUp=!0},getUser:async e=>{const a=u.service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.7)"}),n=await s.post(l.getUser,{code:e},{withCredentials:!0});a.close();const i={_id:n._id,name:n.name,avatar:n.avatar};t.commit("SAVE_USER",{userInfo:i}),window.sessionStorage.userInfo=JSON.stringify(i),m({message:"操作成功",type:"success"});let d=JSON.parse(window.sessionStorage.preventHistory);d&&o.push({path:d.name,query:d.query})},handleSelect:(e,a)=>{h.activeIndex=e},routeChange:(e,a)=>{for(let n=0;n<h.list.length;n++){const a=h.list[n];if(a.path===e.path){h.activeIndex=n+1+"",h.title=a.name;break}}},handleHideMenu:()=>{h.enterSlideUp=!1,h.leaveSlideDown=!0,setTimeout((()=>{h.leaveSlideDown=!1,h.isShow=!1}),300)}}}}),x="/star-blog/assets/logo.920b5df0.jpg";const U=I();h("data-v-e79ab480");const j={key:0,class:"nav"},E={class:"nav-content"},F=p("img",{class:"logo",src:x,alt:"BiaoChenXuYing"},null,-1),O={class:"nav-right"},A={class:"el-dropdown-link"},D=p("i",{class:"el-icon-arrow-down el-icon--right"},null,-1),L={key:0,class:"user-img",src:y,alt:"BiaoChenXuYing"},R=S("登 出"),$={class:"nav-right"},Y=S("登录"),B=S("注册"),H={key:1,class:"nav"},N={class:"nav-mobile"},V={class:"nav-mobile-logo"},X=p("img",{class:"logo fl",src:x,alt:"BiaoChenXuYing"},null,-1),z={class:"title"},J=p("i",{class:"el-icon-menu"},null,-1),q={class:"list"},T=S("首 页"),P=S("文 章"),Q=S("归 档"),G=S("项 目"),K=S("历 程"),W=S("留 言"),Z=S("关 于"),ee={key:0},ae={key:1};g();const ne=U(((e,a,n,s,l,i)=>{const t=v("router-link"),o=v("el-col"),d=v("el-menuItem"),r=v("el-menu"),c=v("el-dropdown-item"),u=v("el-dropdown-menu"),m=v("el-dropdown"),h=v("el-button"),g=v("el-row"),I=v("RegisterAndLogin");return f(),k("div",null,[e.state.isMobile?(f(),k("div",H,[p("div",N,[p("div",V,[p(t,{to:"/"},{default:U((()=>[X])),_:1})]),p("div",z,w(e.state.title),1),p("div",{class:"menu",onClick:a[3]||(a[3]=(...a)=>e.handleMenu&&e.handleMenu(...a))},[J])]),e.state.isShow?(f(),k("div",{key:0,class:["nav-mobile-content",{"enter-slideUp":e.state.enterSlideUp,"leave-slideDown":e.state.leaveSlideDown}]},[p("div",q,[p("div",{onClick:a[4]||(a[4]=a=>e.handleClickMenu("")),class:"item"},[p(t,{to:"/"},{default:U((()=>[T])),_:1})]),p("div",{onClick:a[5]||(a[5]=a=>e.handleClickMenu("/articles")),class:"item"},[p(t,{to:"/articles"},{default:U((()=>[P])),_:1})]),p("div",{onClick:a[6]||(a[6]=a=>e.handleClickMenu("/archive")),class:"item"},[p(t,{to:"/archive"},{default:U((()=>[Q])),_:1})]),p("div",{onClick:a[7]||(a[7]=a=>e.handleClickMenu("/project")),class:"item"},[p(t,{to:"/project"},{default:U((()=>[G])),_:1})]),p("div",{onClick:a[8]||(a[8]=a=>e.handleClickMenu("/timeline")),class:"item"},[p(t,{to:"/timeline"},{default:U((()=>[K])),_:1})]),p("div",{onClick:a[9]||(a[9]=a=>e.handleClickMenu("/message")),class:"item"},[p(t,{to:"/message"},{default:U((()=>[W])),_:1})]),p("div",{onClick:a[10]||(a[10]=a=>e.handleClickMenu("/about")),class:"item"},[p(t,{to:"/about"},{default:U((()=>[Z])),_:1})]),p("div",{onClick:a[11]||(a[11]=a=>e.handleClickMenu("/login")),class:"item"},[e.userInfo._id?(f(),k("span",ee,w(e.userInfo.name),1)):(f(),k("span",ae,"登 录"))]),e.userInfo._id?b("",!0):(f(),k("div",{key:0,onClick:a[12]||(a[12]=a=>e.handleClickMenu("/register")),class:"item"}," 注 册 ")),e.userInfo._id?(f(),k("div",{key:1,onClick:a[13]||(a[13]=a=>e.handleClickMenu("/logout")),class:"item"}," 登 出 ")):b("",!0)])],2)):b("",!0)])):(f(),k("div",j,[p("div",E,[p(g,{gutter:20},{default:U((()=>[p(o,{span:3},{default:U((()=>[p(t,{to:"/"},{default:U((()=>[F])),_:1})])),_:1}),p(o,{span:16},{default:U((()=>[p(r,{router:!0,"default-active":e.state.activeIndex,"active-text-color":"#409eff",class:"el-menu-demo",mode:"horizontal",onSelect:e.handleSelect},{default:U((()=>[(f(!0),k(C,null,_(e.state.list,(e=>(f(),k(d,{route:e.path,index:e.index,key:e.index},{default:U((()=>[S(w(e.name),1)])),_:2},1032,["route","index"])))),128))])),_:1},8,["default-active","onSelect"])])),_:1}),e.userInfo._id?(f(),k(o,{key:0,span:5},{default:U((()=>[p("div",O,[p(m,{onCommand:e.handleLogout},{default:U((()=>[p("span",A,[S(w(e.userInfo.name),1),D]),e.userInfo.avatar?b("",!0):(f(),k("img",L)),e.userInfo.avatar?(f(),k("img",{key:1,class:"user-img",src:e.userInfo.avatar,alt:"BiaoChenXuYing"},null,8,["src"])):b("",!0),p(u,{slot:"dropdown"},{default:U((()=>[p(c,{command:"logout"},{default:U((()=>[R])),_:1})])),_:1})])),_:1},8,["onCommand"])])])),_:1})):(f(),k(o,{key:1,span:4},{default:U((()=>[p("div",$,[p(h,{size:"small",type:"primary",onClick:a[1]||(a[1]=a=>e.handleClick("login"))},{default:U((()=>[Y])),_:1}),p(h,{size:"small",type:"danger",onClick:a[2]||(a[2]=a=>e.handleClick("register"))},{default:U((()=>[B])),_:1})])])),_:1}))])),_:1})])])),e.state.isShow?(f(),k("div",{key:2,class:["mask",{"mask-fade-out":e.state.leaveSlideDown}],onClick:a[14]||(a[14]=(...a)=>e.handleHideMenu&&e.handleHideMenu(...a))},null,2)):b("",!0),p(I,{visible:e.state.visible,isMobile:e.state.isMobile,handleFlag:e.state.handleFlag,onOk:e.handleOk,onCancel:e.handleCancel},null,8,["visible","isMobile","handleFlag","onOk","onCancel"])])}));M.render=ne,M.__scopeId="data-v-e79ab480";export default M;
