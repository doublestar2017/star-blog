import{_ as e,g as a,i as s,s as n,u as l,k as i}from"./index.8ac4e010.js";import{d as t,a as o,j as d,Y as r,r as c,Q as u,_ as m,p as h,l as g,b as v,c as f,e as k,g as p,F as C,S as _,k as S,t as w,f as b,m as I}from"./vendor.b48202c8.js";import{_ as y}from"./user.9f14763c.js";var M=t({name:"Nav",components:{RegisterAndLogin:o((()=>e((()=>import("./RegisterAndLogin.3c60a492.js")),["./assets/RegisterAndLogin.3c60a492.js","./assets/RegisterAndLogin.fe44f83e.css","./assets/vendor.b48202c8.js","./assets/index.8ac4e010.js","./assets/index.d18226f1.css"])))},computed:{userInfo(){let e={_id:"",name:"",avatar:""};return window.sessionStorage.userInfo&&(e=JSON.parse(window.sessionStorage.userInfo),this.$store.commit("SAVE_USER",{userInfo:e})),this.$store.state.user.userInfo&&(e=this.$store.state.user.userInfo),e}},watch:{$route:{handler(e,a){this.routeChange(e,a)},immediate:!0}},mounted(){this.routeChange(this.$route,this.$route);const e=a("code");e&&this.getUser(e)},setup(e,a){const t=d(i),o=r(),h=c({visible:!1,handleFlag:"",title:"首页",list:[{index:"1",path:"/",name:"首页"},{index:"2",path:"/articles",name:"文章"},{index:"3",path:"/archive",name:"归档"},{index:"4",path:"/project",name:"项目"},{index:"5",path:"/timeline",name:"历程"},{index:"6",path:"/message",name:"留言"},{index:"7",path:"/about",name:"关于"}],activeIndex:"0",enterSlideUp:!1,leaveSlideDown:!1,isShow:!1,isMobile:s()}),g=()=>{window.sessionStorage.userInfo="",t.commit("SAVE_USER",{userInfo:{_id:"",name:"",avatar:""}})};return{state:h,handleCancel:e=>{h.visible=e},handleOk:e=>{h.visible=e},handleClick:e=>{h.handleFlag=e,h.visible=!0},handleLogout:g,handleClickMenu:e=>{h.isShow=!1,"/login"===e&&(h.handleFlag="login",h.visible=!0),"/register"===e&&(h.handleFlag="register",h.visible=!0),"/logout"===e&&g()},handleMenu:()=>{h.isShow=!0,h.enterSlideUp=!0},getUser:async e=>{const a=u.service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.7)"}),s=await n.post(l.getUser,{code:e},{withCredentials:!0});a.close();const i={_id:s._id,name:s.name,avatar:s.avatar};t.commit("SAVE_USER",{userInfo:i}),window.sessionStorage.userInfo=JSON.stringify(i),m({message:"操作成功",type:"success"});let d=JSON.parse(window.sessionStorage.preventHistory);d&&o.push({path:d.name,query:d.query})},handleSelect:(e,a)=>{h.activeIndex=e},routeChange:(e,a)=>{for(let s=0;s<h.list.length;s++){const a=h.list[s];if(a.path===e.path){h.activeIndex=s+1+"",h.title=a.name;break}}},handleHideMenu:()=>{h.enterSlideUp=!1,h.leaveSlideDown=!0,setTimeout((()=>{h.leaveSlideDown=!1,h.isShow=!1}),300)}}}});const x=I();h("data-v-7ca69c14");const U={key:0,class:"nav"},j={class:"nav-content"},E=p("img",{class:"logo",src:"./assets/logo.920b5df0.jpg",alt:"BiaoChenXuYing"},null,-1),F={class:"nav-right"},O={class:"el-dropdown-link"},A=p("i",{class:"el-icon-arrow-down el-icon--right"},null,-1),D={key:0,class:"user-img",src:y,alt:"BiaoChenXuYing"},L=S("登 出"),R={class:"nav-right"},$=S("登录"),Y=S("注册"),B={key:1,class:"nav"},H={class:"nav-mobile"},N={class:"nav-mobile-logo"},V=p("img",{class:"logo fl",src:"./assets/logo.920b5df0.jpg",alt:"BiaoChenXuYing"},null,-1),X={class:"title"},z=p("i",{class:"el-icon-menu"},null,-1),J={class:"list"},q=S("首 页"),T=S("文 章"),P=S("归 档"),Q=S("项 目"),G=S("历 程"),K=S("留 言"),W=S("关 于"),Z={key:0},ee={key:1};g();const ae=x(((e,a,s,n,l,i)=>{const t=v("router-link"),o=v("el-col"),d=v("el-menuItem"),r=v("el-menu"),c=v("el-dropdown-item"),u=v("el-dropdown-menu"),m=v("el-dropdown"),h=v("el-button"),g=v("el-row"),I=v("RegisterAndLogin");return f(),k("div",null,[e.state.isMobile?(f(),k("div",B,[p("div",H,[p("div",N,[p(t,{to:"/"},{default:x((()=>[V])),_:1})]),p("div",X,w(e.state.title),1),p("div",{class:"menu",onClick:a[3]||(a[3]=(...a)=>e.handleMenu&&e.handleMenu(...a))},[z])]),e.state.isShow?(f(),k("div",{key:0,class:["nav-mobile-content",{"enter-slideUp":e.state.enterSlideUp,"leave-slideDown":e.state.leaveSlideDown}]},[p("div",J,[p("div",{onClick:a[4]||(a[4]=a=>e.handleClickMenu("")),class:"item"},[p(t,{to:"/"},{default:x((()=>[q])),_:1})]),p("div",{onClick:a[5]||(a[5]=a=>e.handleClickMenu("/articles")),class:"item"},[p(t,{to:"/articles"},{default:x((()=>[T])),_:1})]),p("div",{onClick:a[6]||(a[6]=a=>e.handleClickMenu("/archive")),class:"item"},[p(t,{to:"/archive"},{default:x((()=>[P])),_:1})]),p("div",{onClick:a[7]||(a[7]=a=>e.handleClickMenu("/project")),class:"item"},[p(t,{to:"/project"},{default:x((()=>[Q])),_:1})]),p("div",{onClick:a[8]||(a[8]=a=>e.handleClickMenu("/timeline")),class:"item"},[p(t,{to:"/timeline"},{default:x((()=>[G])),_:1})]),p("div",{onClick:a[9]||(a[9]=a=>e.handleClickMenu("/message")),class:"item"},[p(t,{to:"/message"},{default:x((()=>[K])),_:1})]),p("div",{onClick:a[10]||(a[10]=a=>e.handleClickMenu("/about")),class:"item"},[p(t,{to:"/about"},{default:x((()=>[W])),_:1})]),p("div",{onClick:a[11]||(a[11]=a=>e.handleClickMenu("/login")),class:"item"},[e.userInfo._id?(f(),k("span",Z,w(e.userInfo.name),1)):(f(),k("span",ee,"登 录"))]),e.userInfo._id?b("",!0):(f(),k("div",{key:0,onClick:a[12]||(a[12]=a=>e.handleClickMenu("/register")),class:"item"}," 注 册 ")),e.userInfo._id?(f(),k("div",{key:1,onClick:a[13]||(a[13]=a=>e.handleClickMenu("/logout")),class:"item"}," 登 出 ")):b("",!0)])],2)):b("",!0)])):(f(),k("div",U,[p("div",j,[p(g,{gutter:20},{default:x((()=>[p(o,{span:3},{default:x((()=>[p(t,{to:"/"},{default:x((()=>[E])),_:1})])),_:1}),p(o,{span:16},{default:x((()=>[p(r,{router:!0,"default-active":e.state.activeIndex,"active-text-color":"#409eff",class:"el-menu-demo",mode:"horizontal",onSelect:e.handleSelect},{default:x((()=>[(f(!0),k(C,null,_(e.state.list,(e=>(f(),k(d,{route:e.path,index:e.index,key:e.index},{default:x((()=>[S(w(e.name),1)])),_:2},1032,["route","index"])))),128))])),_:1},8,["default-active","onSelect"])])),_:1}),e.userInfo._id?(f(),k(o,{key:0,span:5},{default:x((()=>[p("div",F,[p(m,{onCommand:e.handleLogout},{default:x((()=>[p("span",O,[S(w(e.userInfo.name),1),A]),e.userInfo.avatar?b("",!0):(f(),k("img",D)),e.userInfo.avatar?(f(),k("img",{key:1,class:"user-img",src:e.userInfo.avatar,alt:"BiaoChenXuYing"},null,8,["src"])):b("",!0),p(u,{slot:"dropdown"},{default:x((()=>[p(c,{command:"logout"},{default:x((()=>[L])),_:1})])),_:1})])),_:1},8,["onCommand"])])])),_:1})):(f(),k(o,{key:1,span:4},{default:x((()=>[p("div",R,[p(h,{size:"small",type:"primary",onClick:a[1]||(a[1]=a=>e.handleClick("login"))},{default:x((()=>[$])),_:1}),p(h,{size:"small",type:"danger",onClick:a[2]||(a[2]=a=>e.handleClick("register"))},{default:x((()=>[Y])),_:1})])])),_:1}))])),_:1})])])),e.state.isShow?(f(),k("div",{key:2,class:["mask",{"mask-fade-out":e.state.leaveSlideDown}],onClick:a[14]||(a[14]=(...a)=>e.handleHideMenu&&e.handleHideMenu(...a))},null,2)):b("",!0),p(I,{visible:e.state.visible,isMobile:e.state.isMobile,handleFlag:e.state.handleFlag,onOk:e.handleOk,onCancel:e.handleCancel},null,8,["visible","isMobile","handleFlag","onOk","onCancel"])])}));M.render=ae,M.__scopeId="data-v-7ca69c14";export default M;
