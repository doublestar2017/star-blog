import{_ as e,g as a,i as n,s,u as l,k as i,e as t}from"./index.88878458.js";import{d as o,a as d,j as r,Z as c,r as u,R as m,_ as h,p as v,l as g,b as f,c as k,e as p,g as C,F as _,U as w,k as S,t as b,f as I,m as y}from"./vendor.4d6ce351.js";import{_ as M}from"./user.9f14763c.js";var x=o({name:"Nav",components:{RegisterAndLogin:d((()=>e((()=>import("./RegisterAndLogin.5d4cd6bc.js")),["/star-blog/assets/RegisterAndLogin.5d4cd6bc.js","/star-blog/assets/RegisterAndLogin.e663d6f6.css","/star-blog/assets/vendor.4d6ce351.js","/star-blog/assets/index.88878458.js","/star-blog/assets/index.7248075e.css"])))},computed:{userInfo(){let e={_id:"",name:"",avatar:""};return window.sessionStorage.userInfo&&(e=JSON.parse(window.sessionStorage.userInfo),this.$store.commit("SAVE_USER",{userInfo:e})),this.$store.state.user.userInfo&&(e=this.$store.state.user.userInfo),e}},watch:{$route:{handler(e,a){this.routeChange(e,a)},immediate:!0}},mounted(){this.routeChange(this.$route,this.$route);const e=a("code");e&&this.getUser(e)},setup(e,a){const t=r(i),o=c(),d=u({visible:!1,handleFlag:"",title:"首页",list:[{index:"1",path:"/",name:"首页"},{index:"2",path:"/articles",name:"文章"},{index:"3",path:"/archive",name:"归档"},{index:"4",path:"/project",name:"项目"},{index:"5",path:"/timeline",name:"历程"},{index:"6",path:"/message",name:"留言"},{index:"7",path:"/about",name:"关于"}],activeIndex:"0",enterSlideUp:!1,leaveSlideDown:!1,isShow:!1,isMobile:n()}),v=()=>{window.sessionStorage.userInfo="",t.commit("SAVE_USER",{userInfo:{_id:"",name:"",avatar:""}})};return{state:d,handleCancel:e=>{d.visible=e},handleOk:e=>{d.visible=e},handleClick:e=>{d.handleFlag=e,d.visible=!0},handleLogout:v,handleClickMenu:e=>{d.isShow=!1,"/login"===e&&(d.handleFlag="login",d.visible=!0),"/register"===e&&(d.handleFlag="register",d.visible=!0),"/logout"===e&&v()},handleMenu:()=>{d.isShow=!0,d.enterSlideUp=!0},getUser:async e=>{const a=m.service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.7)"}),n=await s.post(l.getUser,{code:e},{withCredentials:!0});a.close();const i={_id:n._id,name:n.name,avatar:n.avatar};t.commit("SAVE_USER",{userInfo:i}),window.sessionStorage.userInfo=JSON.stringify(i),h({message:"操作成功",type:"success"});let d=JSON.parse(window.sessionStorage.preventHistory);d&&o.push({path:d.name,query:d.query})},handleSelect:(e,a)=>{d.activeIndex=e},routeChange:(e,a)=>{for(let n=0;n<d.list.length;n++){const a=d.list[n];if(a.path===e.path){d.activeIndex=n+1+"",d.title=a.name;break}}},handleHideMenu:()=>{d.enterSlideUp=!1,d.leaveSlideDown=!0,setTimeout((()=>{d.leaveSlideDown=!1,d.isShow=!1}),300)}}}});const U=y();v("data-v-e79ab480");const j={key:0,class:"nav"},E={class:"nav-content"},F=C("img",{class:"logo",src:t,alt:"BiaoChenXuYing"},null,-1),O={class:"nav-right"},R={class:"el-dropdown-link"},A=C("i",{class:"el-icon-arrow-down el-icon--right"},null,-1),D={key:0,class:"user-img",src:M,alt:"BiaoChenXuYing"},L=S("登 出"),$={class:"nav-right"},B=S("登录"),H=S("注册"),N={key:1,class:"nav"},V={class:"nav-mobile"},X={class:"nav-mobile-logo"},Y=C("img",{class:"logo fl",src:t,alt:"BiaoChenXuYing"},null,-1),z={class:"title"},J=C("i",{class:"el-icon-menu"},null,-1),q={class:"list"},T=S("首 页"),P=S("文 章"),Z=S("归 档"),G=S("项 目"),K=S("历 程"),Q=S("留 言"),W=S("关 于"),ee={key:0},ae={key:1};g();const ne=U(((e,a,n,s,l,i)=>{const t=f("router-link"),o=f("el-col"),d=f("el-menuItem"),r=f("el-menu"),c=f("el-dropdown-item"),u=f("el-dropdown-menu"),m=f("el-dropdown"),h=f("el-button"),v=f("el-row"),g=f("RegisterAndLogin");return k(),p("div",null,[e.state.isMobile?(k(),p("div",N,[C("div",V,[C("div",X,[C(t,{to:"/"},{default:U((()=>[Y])),_:1})]),C("div",z,b(e.state.title),1),C("div",{class:"menu",onClick:a[3]||(a[3]=(...a)=>e.handleMenu&&e.handleMenu(...a))},[J])]),e.state.isShow?(k(),p("div",{key:0,class:["nav-mobile-content",{"enter-slideUp":e.state.enterSlideUp,"leave-slideDown":e.state.leaveSlideDown}]},[C("div",q,[C("div",{onClick:a[4]||(a[4]=a=>e.handleClickMenu("")),class:"item"},[C(t,{to:"/"},{default:U((()=>[T])),_:1})]),C("div",{onClick:a[5]||(a[5]=a=>e.handleClickMenu("/articles")),class:"item"},[C(t,{to:"/articles"},{default:U((()=>[P])),_:1})]),C("div",{onClick:a[6]||(a[6]=a=>e.handleClickMenu("/archive")),class:"item"},[C(t,{to:"/archive"},{default:U((()=>[Z])),_:1})]),C("div",{onClick:a[7]||(a[7]=a=>e.handleClickMenu("/project")),class:"item"},[C(t,{to:"/project"},{default:U((()=>[G])),_:1})]),C("div",{onClick:a[8]||(a[8]=a=>e.handleClickMenu("/timeline")),class:"item"},[C(t,{to:"/timeline"},{default:U((()=>[K])),_:1})]),C("div",{onClick:a[9]||(a[9]=a=>e.handleClickMenu("/message")),class:"item"},[C(t,{to:"/message"},{default:U((()=>[Q])),_:1})]),C("div",{onClick:a[10]||(a[10]=a=>e.handleClickMenu("/about")),class:"item"},[C(t,{to:"/about"},{default:U((()=>[W])),_:1})]),C("div",{onClick:a[11]||(a[11]=a=>e.handleClickMenu("/login")),class:"item"},[e.userInfo._id?(k(),p("span",ee,b(e.userInfo.name),1)):(k(),p("span",ae,"登 录"))]),e.userInfo._id?I("",!0):(k(),p("div",{key:0,onClick:a[12]||(a[12]=a=>e.handleClickMenu("/register")),class:"item"}," 注 册 ")),e.userInfo._id?(k(),p("div",{key:1,onClick:a[13]||(a[13]=a=>e.handleClickMenu("/logout")),class:"item"}," 登 出 ")):I("",!0)])],2)):I("",!0)])):(k(),p("div",j,[C("div",E,[C(v,{gutter:20},{default:U((()=>[C(o,{span:3},{default:U((()=>[C(t,{to:"/"},{default:U((()=>[F])),_:1})])),_:1}),C(o,{span:16},{default:U((()=>[C(r,{router:!0,"default-active":e.state.activeIndex,"active-text-color":"#409eff",class:"el-menu-demo",mode:"horizontal",onSelect:e.handleSelect},{default:U((()=>[(k(!0),p(_,null,w(e.state.list,(e=>(k(),p(d,{route:e.path,index:e.index,key:e.index},{default:U((()=>[S(b(e.name),1)])),_:2},1032,["route","index"])))),128))])),_:1},8,["default-active","onSelect"])])),_:1}),e.userInfo._id?(k(),p(o,{key:0,span:5},{default:U((()=>[C("div",O,[C(m,{onCommand:e.handleLogout},{default:U((()=>[C("span",R,[S(b(e.userInfo.name),1),A]),e.userInfo.avatar?I("",!0):(k(),p("img",D)),e.userInfo.avatar?(k(),p("img",{key:1,class:"user-img",src:e.userInfo.avatar,alt:"BiaoChenXuYing"},null,8,["src"])):I("",!0),C(u,{slot:"dropdown"},{default:U((()=>[C(c,{command:"logout"},{default:U((()=>[L])),_:1})])),_:1})])),_:1},8,["onCommand"])])])),_:1})):(k(),p(o,{key:1,span:4},{default:U((()=>[C("div",$,[C(h,{size:"small",type:"primary",onClick:a[1]||(a[1]=a=>e.handleClick("login"))},{default:U((()=>[B])),_:1}),C(h,{size:"small",type:"danger",onClick:a[2]||(a[2]=a=>e.handleClick("register"))},{default:U((()=>[H])),_:1})])])),_:1}))])),_:1})])])),e.state.isShow?(k(),p("div",{key:2,class:["mask",{"mask-fade-out":e.state.leaveSlideDown}],onClick:a[14]||(a[14]=(...a)=>e.handleHideMenu&&e.handleHideMenu(...a))},null,2)):I("",!0),C(g,{visible:e.state.visible,isMobile:e.state.isMobile,handleFlag:e.state.handleFlag,onOk:e.handleOk,onCancel:e.handleCancel},null,8,["visible","isMobile","handleFlag","onOk","onCancel"])])}));x.render=ne,x.__scopeId="data-v-e79ab480";export default x;
